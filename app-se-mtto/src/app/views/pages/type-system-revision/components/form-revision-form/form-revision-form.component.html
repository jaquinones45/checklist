<ng-template #content let-modal>
  <div *ngIf=modal>
    <div class="modal-header d-flex flex-row justify-content-between px-3 pt-2 pb-0 m-0">
      <h5>{{ nombre }}</h5>
      <button id="closeModal" type="button" class="close" aria-label="Close" data-backdrop="static" data-keyboard="false" (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">×</span>
      </button>
    </div>
    <form #myForm="ngForm" (ngSubmit)="clickSaveOrUpdate(myForm)" novalidate>
      <div class="modal-body mt-0">

        <div class="row">
          <div class="col-6">
            <div class="form-group">
              <label class="control-label">Componente *</label>
              <ejs-dropdownlist 
                id='ddlelement1' 
                class="col-12 p-0" 
                [dataSource]='responseComponent'
                [fields]="{ text: 'name', value: 'id' }"
                [(value)]='data.component_id'
                (change)="selectComponent($event)"
              ></ejs-dropdownlist>
            </div>
          </div>
          <div class="col-6">
            <div class="form-group">
              <label class="control-label">Lista de revision *</label>
              <ejs-dropdownlist 
                id='ddlelement1' 
                class="col-12 p-0" 
                [dataSource]='responseForm'
                [fields]="{ text: 'name', value: 'id' }"
                [(value)]='data.form_id'
                (change)="selectForm($event)"
              ></ejs-dropdownlist>
            </div>
          </div>
          <div class="col-12">
            <div class="table-responsive mt-3" *ngIf="data.questions.length > 0">
              <table class="table table-sm">
                <thead>
                  <tr class="font-overpass">
                    <th class="text-left" style="width:15%">Evaluación</th>
                    <th class="text-left" style="width:25%">Resultado</th>
                    <th class="text-left" style="width:60%">Notas</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let element of data.questions">
                    <td class="text-left p-1">{{ element.question }}</td>
                    <td class="text-left p-1">
                      <ejs-dropdownlist 
                        id='ddlelement1' 
                        class="col-12 p-0" 
                        [dataSource]='responseTypeQuestion'
                        [fields]="{ text: 'name', value: 'id' }"
                        [(value)]='element.type_question_id'
                        (change)="selectComponent($event)"
                      ></ejs-dropdownlist>
                    </td>
                    <td class="text-left p-1">
                      <textarea 
                        class="form-control form-control-sm text-sm cusFilter"
                        [(ngModel)]="element.notes"
                        rows="1"
                        *ngIf="element.type_question_id == 2"
                      ></textarea>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div 
              id="external-events" 
              class="external-events pt-3"
              *ngIf="data.questions.length  == 0"
            >
              <div class="fc-event-page fc-h-event">
                <p class="m-0" style="font-size: 14px">
                  No se encontraron registros de las preguntas
                </p>
              </div>
            </div>
          </div>
        </div>

        <div class="mt-2">
          <ngb-alert [type]="'success'" *ngIf="message != ''"><div [innerHtml]="message"></div></ngb-alert>
          <ngb-alert [type]="'warning'" *ngIf="error != ''"><div [innerHtml]="error"></div></ngb-alert>
        </div>

      </div>
      <div class="modal-footer d-flex justify-content-between">
        <div class="flex-col flex-nowrap justify-content-center text-xs"></div>
        <button type="submit" class="btn btn-outline-dark btn-sm" [disabled]="data.load">
          <i class="feather icon-save"></i> Guardar
        </button>
      </div>
    </form>
  </div>
</ng-template>

<i 
  (click)="open(content)"
  class="feather icon-plus"
  style="cursor: pointer;font-size: 20px;color: #C4C4C4;"
  data-toggle="tooltip" 
  data-placement="top" 
  title="Nuevo formulario de revisión"
  *ngIf=!update
></i>
<i 
  (click)="open(content)"
  class="feather icon-edit"
  style="cursor: pointer;font-size: 20px;color: #C4C4C4;"
  data-toggle="tooltip" 
  data-placement="top" 
  title="Editar formulario de revisión"
  *ngIf=update
></i>